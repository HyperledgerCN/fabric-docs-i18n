

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Capability Requirements &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CouchDB as the State Database" href="couchdb_as_state_database.html" />
    <link rel="prev" title="Channels" href="channels.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
<br>
<a href="https://chat.hyperledger.org">Rocket Chat</a>  <a href="https://jenkins.hyperledger.org/">CI</a>
<a href="http://stackoverflow.com/questions/tagged/hyperledger-fabric">StackOverflow</a>
<br>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
  <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Welcome to Hyperledger Fabric</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops_guide.html">Operations Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_ref.html">Commands Reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="architecture.html">Architecture Reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="arch-deep-dive.html">Architecture Explained</a></li>
<li class="toctree-l3"><a class="reference internal" href="txflow.html">Transaction Flow</a></li>
<li class="toctree-l3"><a class="reference external" href="http://hyperledger-fabric-ca.readthedocs.io/en/latest">Hyperledger Fabric CA's User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="fabric-sdks.html">Hyperledger Fabric SDKs</a></li>
<li class="toctree-l3"><a class="reference internal" href="channels.html">Channels</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Capability Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#defining-capability-requirements">Defining Capability Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-capabilities">Setting Capabilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="couchdb_as_state_database.html">CouchDB as the State Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="peer_event_services.html">Peer channel-based event services</a></li>
<li class="toctree-l3"><a class="reference internal" href="readwrite.html">Read-Write set semantics</a></li>
<li class="toctree-l3"><a class="reference internal" href="gossip.html">Gossip data dissemination protocol</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Fabric-FAQ.html">Hyperledger Fabric FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="ordering-service-faq.html">Ordering Service FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="questions.html">Still Have Questions?</a></li>
<li class="toctree-l2"><a class="reference internal" href="status.html">Status</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html">Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops_guide.html">Operations Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_ref.html">Commands Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="architecture.html">Architecture Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="arch-deep-dive.html">Architecture Explained</a></li>
<li class="toctree-l2"><a class="reference internal" href="txflow.html">Transaction Flow</a></li>
<li class="toctree-l2"><a class="reference external" href="http://hyperledger-fabric-ca.readthedocs.io/en/latest">Hyperledger Fabric CA's User Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="fabric-sdks.html">Hyperledger Fabric SDKs</a></li>
<li class="toctree-l2"><a class="reference internal" href="channels.html">Channels</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Capability Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defining-capability-requirements">Defining Capability Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-capabilities">Setting Capabilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#capabilities-in-an-initial-configuration">Capabilities in an Initial Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="couchdb_as_state_database.html">CouchDB as the State Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="peer_event_services.html">Peer channel-based event services</a></li>
<li class="toctree-l2"><a class="reference internal" href="readwrite.html">Read-Write set semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="gossip.html">Gossip data dissemination protocol</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Fabric-FAQ.html">Hyperledger Fabric FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="ordering-service-faq.html">Ordering Service FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="questions.html">Still Have Questions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">Status</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hyperledger-fabricdocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="architecture.html">Architecture Reference</a> &raquo;</li>
        
      <li>Capability Requirements</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/capability_requirements.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="capability-requirements">
<h1>Capability Requirements<a class="headerlink" href="#capability-requirements" title="Permalink to this headline">¶</a></h1>
<p>Because Fabric is a distributed system that will usually involve multiple
organizations (sometimes in different countries or even continents), it is
possible (and typical) that many different versions of Fabric code will exist in
the network. Nevertheless, it’s vital that networks process transactions in the
same way so that everyone has the same view of the current network state.</p>
<p>This means that every network – and every channel within that network – must
define a set of what we call “capabilities” to be able to participate in
processing transactions. For example, Fabric v1.1 introduces new MSP role types
of “Peer” and “Client”. However, if a v1.0 peer does not understand these new
role types, it will not be able to appropriately evaluate an endorsement policy
that references them. This means that before the new role types may be used, the
network must agree to enable the v1.1 <code class="docutils literal notranslate"><span class="pre">channel</span></code> capability requirement,
ensuring that all peers come to the same decision.</p>
<p>Only binaries which support the required capabilities will be able to participate in the
channel, and newer binary versions will not enable new validation logic until the
corresponding capability is enabled.  In this way, capability requirements ensure that
even with disparate builds and versions, it is not possible for the network to suffer a
state fork.</p>
<div class="section" id="defining-capability-requirements">
<h2>Defining Capability Requirements<a class="headerlink" href="#defining-capability-requirements" title="Permalink to this headline">¶</a></h2>
<p>Capability requirements are defined per channel in the channel configuration (found
in the channel’s most recent configuration block). The channel configuration contains
three locations, each of which defines a capability of a different type.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="33%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Capability Type</th>
<th class="head">Canonical Path</th>
<th class="head">JSON Path</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Channel</td>
<td>/Channel/Capabilities</td>
<td>.channel_group.values.Capabilities</td>
</tr>
<tr class="row-odd"><td>Orderer</td>
<td>/Channel/Orderer/Capabilities</td>
<td>.channel_group.groups.Orderer.values.Capabilities</td>
</tr>
<tr class="row-even"><td>Application</td>
<td>/Channel/Application/Capabilities</td>
<td>.channel_group.groups.Application.values.
Capabilities</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><strong>Channel:</strong> these capabilities apply to both peer and orderers and are located in
the root <code class="docutils literal notranslate"><span class="pre">Channel</span></code> group.</li>
<li><strong>Orderer:</strong> apply to orderers only and are located in the <code class="docutils literal notranslate"><span class="pre">Orderer</span></code> group.</li>
<li><strong>Application:</strong> apply to peers only and are located in the <code class="docutils literal notranslate"><span class="pre">Application</span></code> group.</li>
</ul>
<p>The capabilities are broken into these groups in order to align with the existing
administrative structure. Updating orderer capabilities is something the ordering orgs
would manage independent of the application orgs. Similarly, updating application
capabilities is something only the application admins would manage. By splitting the
capabilities between “Orderer” and “Application”, a hypothetical network could run a
v1.6 ordering service while supporting a v1.3 peer application network.</p>
<p>However, some capabilities cross both the ‘Application’ and ‘Orderer’ groups. As we
saw earlier, adding a new MSP role type is something both the orderer and application
admins agree to and need to recognize. The orderer must understand the meaning
of MSP roles in order to allow the transactions to pass through ordering, while
the peers must understand the roles in order to validate the transaction. These
kinds of capabilities – which span both the application and orderer components
– are defined in the top level “Channel” group.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is possible that the channel capabilities are defined to be at version
v1.3 while the orderer and application capabilities are defined to be at
version 1.1 and v1.4, respectively. Enabling a capability at the “Channel”
group level does not imply that this same capability is available at the
more specific “Orderer” and “Application” group levels.</p>
</div>
</div>
<div class="section" id="setting-capabilities">
<h2>Setting Capabilities<a class="headerlink" href="#setting-capabilities" title="Permalink to this headline">¶</a></h2>
<p>Capabilities are set as part of the channel configuration (either as part of the
initial configuration – which we’ll talk about in a moment – or as part of a
reconfiguration).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We have a two documents that talk through different aspects of channel
reconfigurations. First, we have a tutorial that will take you through
the process of <a class="reference internal" href="channel_update_tutorial.html"><span class="doc">Adding an Org to a Channel</span></a>. And we also have a document that
talks through <a class="reference internal" href="config_update.html"><span class="doc">Updating a Channel Configuration</span></a> which gives an overview of the
different kinds of updates that are possible as well as a fuller look
at the signature process.</p>
</div>
<p>Because new channels copy the configuration of the Orderer System Channel by
default, new channels will automatically be configured to work with the orderer
and channel capabilities of the Orderer System Channel and the application
capabilities specified by the channel creation transaction. Channels that already
exist, however, must be reconfigured.</p>
<p>The schema for the Capabilities value is defined in the protobuf as:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">message</span> <span class="n">Capabilities</span> <span class="p">{</span>
      <span class="nb">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="n">Capability</span><span class="o">&gt;</span> <span class="n">capabilities</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">message</span> <span class="n">Capability</span> <span class="p">{</span> <span class="p">}</span>
</pre></div>
</div>
<p>As an example, rendered in JSON:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;V1_1&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="capabilities-in-an-initial-configuration">
<h3>Capabilities in an Initial Configuration<a class="headerlink" href="#capabilities-in-an-initial-configuration" title="Permalink to this headline">¶</a></h3>
<p>In the <code class="docutils literal notranslate"><span class="pre">configtx.yaml</span></code> file distributed in the <code class="docutils literal notranslate"><span class="pre">config</span></code> directory of the release
artifacts, there is a <code class="docutils literal notranslate"><span class="pre">Capabilities</span></code> section which enumerates the possible capabilities
for each capability type (Channel, Orderer, and Application).</p>
<p>The simplest way to enable capabilities is to pick a v1.1 sample profile and customize
it for your network. For example:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SampleSingleMSPSoloV1_1</span><span class="p">:</span>
    <span class="n">Capabilities</span><span class="p">:</span>
        <span class="o">&lt;&lt;</span><span class="p">:</span> <span class="o">*</span><span class="n">GlobalCapabilities</span>
    <span class="n">Orderer</span><span class="p">:</span>
        <span class="o">&lt;&lt;</span><span class="p">:</span> <span class="o">*</span><span class="n">OrdererDefaults</span>
        <span class="n">Organizations</span><span class="p">:</span>
            <span class="o">-</span> <span class="o">*</span><span class="n">SampleOrg</span>
        <span class="n">Capabilities</span><span class="p">:</span>
            <span class="o">&lt;&lt;</span><span class="p">:</span> <span class="o">*</span><span class="n">OrdererCapabilities</span>
    <span class="n">Consortiums</span><span class="p">:</span>
        <span class="n">SampleConsortium</span><span class="p">:</span>
            <span class="n">Organizations</span><span class="p">:</span>
                <span class="o">-</span> <span class="o">*</span><span class="n">SampleOrg</span>
</pre></div>
</div>
<p>Note that there is a <code class="docutils literal notranslate"><span class="pre">Capabilities</span></code> section defined at the root level (for the channel
capabilities), and at the Orderer level (for orderer capabilities). The sample above uses
a YAML reference to include the capabilities as defined at the bottom of the YAML.</p>
<p>When defining the orderer system channel there is no Application section, as those
capabilities are defined during the creation of an application channel. To define a new
channel’s application capabilities at channel creation time, the application admins should
model their channel creation transaction after the <code class="docutils literal notranslate"><span class="pre">SampleSingleMSPChannelV1_1</span></code> profile.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SampleSingleMSPChannelV1_1</span><span class="p">:</span>
     <span class="n">Consortium</span><span class="p">:</span> <span class="n">SampleConsortium</span>
     <span class="n">Application</span><span class="p">:</span>
         <span class="n">Organizations</span><span class="p">:</span>
             <span class="o">-</span> <span class="o">*</span><span class="n">SampleOrg</span>
         <span class="n">Capabilities</span><span class="p">:</span>
             <span class="o">&lt;&lt;</span><span class="p">:</span> <span class="o">*</span><span class="n">ApplicationCapabilities</span>
</pre></div>
</div>
<p>Here, the Application section has a new element <code class="docutils literal notranslate"><span class="pre">Capabilities</span></code> which references the
<code class="docutils literal notranslate"><span class="pre">ApplicationCapabilities</span></code> section defined at the end of the YAML.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The capabilities for the Channel and Orderer sections are inherited from
the definition in the ordering system channel and are automatically included
by the orderer during the process of channel creation.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="couchdb_as_state_database.html" class="btn btn-neutral float-right" title="CouchDB as the State Database" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="channels.html" class="btn btn-neutral" title="Channels" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>
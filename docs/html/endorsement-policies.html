

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Endorsement policies &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Error handling" href="error-handling.html" />
    <link rel="prev" title="Channel Configuration (configtx)" href="configtx.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
<br>
<a href="https://chat.hyperledger.org">Rocket Chat</a>  <a href="https://jenkins.hyperledger.org/">CI</a>
<a href="http://stackoverflow.com/questions/tagged/hyperledger-fabric">StackOverflow</a>
<br>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
  <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Welcome to Hyperledger Fabric</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ops_guide.html">Operations Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="upgrade_to_one_point_one.html">Upgrading from v1.0.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_update.html">Updating a Channel Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="msp.html">Membership Service Providers (MSP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="configtx.html">Channel Configuration (configtx)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Endorsement policies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#endorsement-policy-syntax-in-the-cli">Endorsement policy syntax in the CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#specifying-endorsement-policies-for-a-chaincode">Specifying endorsement policies for a chaincode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="error-handling.html">Error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging-control.html">Logging Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="enable_tls.html">Securing Communication With Transport Layer Security (TLS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="kafka.html">Bringing up a Kafka-based Ordering Service</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="command_ref.html">Commands Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architecture Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fabric-FAQ.html">Hyperledger Fabric FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="ordering-service-faq.html">Ordering Service FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="questions.html">Still Have Questions?</a></li>
<li class="toctree-l2"><a class="reference internal" href="status.html">Status</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html">Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="ops_guide.html">Operations Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="upgrade_to_one_point_one.html">Upgrading from v1.0.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="config_update.html">Updating a Channel Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="msp.html">Membership Service Providers (MSP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="configtx.html">Channel Configuration (configtx)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Endorsement policies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#endorsement-policy-syntax-in-the-cli">Endorsement policy syntax in the CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#specifying-endorsement-policies-for-a-chaincode">Specifying endorsement policies for a chaincode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="error-handling.html">Error handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging-control.html">Logging Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="enable_tls.html">Securing Communication With Transport Layer Security (TLS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka.html">Bringing up a Kafka-based Ordering Service</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_ref.html">Commands Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fabric-FAQ.html">Hyperledger Fabric FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="ordering-service-faq.html">Ordering Service FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="questions.html">Still Have Questions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">Status</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hyperledger-fabricdocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="ops_guide.html">Operations Guides</a> &raquo;</li>
        
      <li>Endorsement policies</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/endorsement-policies.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="endorsement-policies">
<h1>Endorsement policies<a class="headerlink" href="#endorsement-policies" title="Permalink to this headline">¶</a></h1>
<p>Endorsement policies are used to instruct a peer on how to decide
whether a transaction is properly endorsed. When a peer receives a
transaction, it invokes the VSCC (Validation System Chaincode)
associated with the transaction’s Chaincode as part of the transaction
validation flow to determine the validity of the transaction. Recall
that a transaction contains one or more endorsement from as many
endorsing peers. VSCC is tasked to make the following determinations:</p>
<blockquote>
<div><ul class="simple">
<li>all endorsements are valid (i.e. they are valid signatures from valid
certificates over the expected message)</li>
<li>there is an appropriate number of endorsements</li>
<li>endorsements come from the expected source(s)</li>
</ul>
</div></blockquote>
<p>Endorsement policies are a way of specifying the second and third
points.</p>
<div class="section" id="endorsement-policy-syntax-in-the-cli">
<h2>Endorsement policy syntax in the CLI<a class="headerlink" href="#endorsement-policy-syntax-in-the-cli" title="Permalink to this headline">¶</a></h2>
<p>In the CLI, a simple language is used to express policies in terms of
boolean expressions over principals.</p>
<p>A principal is described in terms of the MSP that is tasked to validate
the identity of the signer and of the role that the signer has within
that MSP. Four roles are supported: <strong>member</strong>, <strong>admin</strong>, <strong>client</strong>, and <strong>peer</strong>.
Principals are described as <code class="docutils literal notranslate"><span class="pre">MSP</span></code>.<code class="docutils literal notranslate"><span class="pre">ROLE</span></code>, where <code class="docutils literal notranslate"><span class="pre">MSP</span></code> is the MSP
ID that is required, and <code class="docutils literal notranslate"><span class="pre">ROLE</span></code> is one of the four strings
<code class="docutils literal notranslate"><span class="pre">member</span></code>, <code class="docutils literal notranslate"><span class="pre">admin</span></code>, <code class="docutils literal notranslate"><span class="pre">client</span></code> and <code class="docutils literal notranslate"><span class="pre">peer</span></code>. Examples of valid principals are
<code class="docutils literal notranslate"><span class="pre">'Org0.admin'</span></code> (any administrator of the <code class="docutils literal notranslate"><span class="pre">Org0</span></code> MSP) or
<code class="docutils literal notranslate"><span class="pre">'Org1.member'</span></code> (any member of the <code class="docutils literal notranslate"><span class="pre">Org1</span></code> MSP),
<code class="docutils literal notranslate"><span class="pre">'Org1.client'</span></code> (any client of the <code class="docutils literal notranslate"><span class="pre">Org1</span></code> MSP), and
<code class="docutils literal notranslate"><span class="pre">'Org1.peer'</span></code> (any peer of the <code class="docutils literal notranslate"><span class="pre">Org1</span></code> MSP).</p>
<p>The syntax of the language is:</p>
<p><code class="docutils literal notranslate"><span class="pre">EXPR(E[,</span> <span class="pre">E...])</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">EXPR</span></code> is either <code class="docutils literal notranslate"><span class="pre">AND</span></code> or <code class="docutils literal notranslate"><span class="pre">OR</span></code>, representing the two boolean
expressions and <code class="docutils literal notranslate"><span class="pre">E</span></code> is either a principal (with the syntax described
above) or another nested call to <code class="docutils literal notranslate"><span class="pre">EXPR</span></code>.</p>
<dl class="docutils">
<dt>For example:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">AND('Org1.member',</span> <span class="pre">'Org2.member',</span> <span class="pre">'Org3.member')</span></code>
requests 1 signature from each of the three principals</li>
<li><code class="docutils literal notranslate"><span class="pre">OR('Org1.member',</span> <span class="pre">'Org2.member')</span></code> requests 1 signature from either
one of the two principals</li>
<li><code class="docutils literal notranslate"><span class="pre">OR('Org1.member',</span> <span class="pre">AND('Org2.member',</span> <span class="pre">'Org3.member'))</span></code>
requests either one signature from a member of the <code class="docutils literal notranslate"><span class="pre">Org1</span></code> MSP
or 1 signature from a member of the <code class="docutils literal notranslate"><span class="pre">Org2</span></code> MSP and 1 signature
from a member of the <code class="docutils literal notranslate"><span class="pre">Org3</span></code> MSP.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="specifying-endorsement-policies-for-a-chaincode">
<h2>Specifying endorsement policies for a chaincode<a class="headerlink" href="#specifying-endorsement-policies-for-a-chaincode" title="Permalink to this headline">¶</a></h2>
<p>Using this language, a chaincode deployer can request that the
endorsements for a chaincode be validated against the specified policy.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if not specified at instantiation time, the endorsement policy
defaults to “any member of the organizations in the channel”.
For example, a channel with “Org1” and “Org2” would have a default
endorsement policy of “OR(‘Org1.member’, ‘Org2.member’)”.</p>
</div>
<p>The policy can be specified at instantiate time using the <code class="docutils literal notranslate"><span class="pre">-P</span></code> switch,
followed by the policy.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peer</span> <span class="n">chaincode</span> <span class="n">instantiate</span> <span class="o">-</span><span class="n">C</span> <span class="o">&lt;</span><span class="n">channelid</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">n</span> <span class="n">mycc</span> <span class="o">-</span><span class="n">P</span> <span class="s2">&quot;AND(&#39;Org1.member&#39;, &#39;Org2.member&#39;)&quot;</span>
</pre></div>
</div>
<p>This command deploys chaincode <code class="docutils literal notranslate"><span class="pre">mycc</span></code> with the policy <code class="docutils literal notranslate"><span class="pre">AND('Org1.member',</span>
<span class="pre">'Org2.member')</span></code> which would require that a member of both Org1 and Org2 sign
the transaction.</p>
<p>Notice that, if the identity classification is enabled (see <a class="reference external" href="http://hyperledger-fabric.readthedocs.io/en/latest/msp.html">MSP Documentation</a>),
one can use the PEER role to restrict endorsement to only peers.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peer</span> <span class="n">chaincode</span> <span class="n">instantiate</span> <span class="o">-</span><span class="n">C</span> <span class="o">&lt;</span><span class="n">channelid</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">n</span> <span class="n">mycc</span> <span class="o">-</span><span class="n">P</span> <span class="s2">&quot;AND(&#39;Org1.peer&#39;, &#39;Org2.peer&#39;)&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A new organization added to the channel after instantiation can query a chaincode
(provided the query has appropriate authorization as defined by channel policies
and any application level checks enforced by the chaincode) but will not be able
to commit a transaction endorsed by it.  The endorsement policy needs to be modified
to allow transactions to be committed with endorsements from the new organization
(see <a class="reference external" href="http://hyperledger-fabric.readthedocs.io/en/latest/channel_update.html">Upgrade &amp; invoke</a>).</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="error-handling.html" class="btn btn-neutral float-right" title="Error handling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="configtx.html" class="btn btn-neutral" title="Channel Configuration (configtx)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>